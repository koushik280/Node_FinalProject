
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-md-6">

      <% if (flash && flash.error && flash.error.length) { %>
        <div class="alert alert-danger"><%= flash.error[0] %></div>
      <% } %>
      <% if (flash && flash.success && flash.success.length) { %>
        <div class="alert alert-success"><%= flash.success[0] %></div>
      <% } %>

      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="mb-3">Change password</h5>

          <form id="changePwdForm" method="POST" action="/profile/change-password" novalidate>
            <div class="mb-3">
              <label class="form-label">Old password</label>
              <input name="oldPassword" type="password" class="form-control form-control-compact" required minlength="6" />
            </div>

            <div class="mb-3">
              <label class="form-label">New password</label>
              <input name="newPassword" id="newPassword" type="password" class="form-control form-control-compact" required minlength="6" />
              <div class="form-text small">Minimum 6 characters (adjust to your policy)</div>
            </div>

            <div class="mb-3">
              <label class="form-label">Confirm new password</label>
              <input name="confirmPassword" id="confirmPassword" type="password" class="form-control form-control-compact" required minlength="6" />
            </div>

            <div class="d-flex gap-2">
              <button class="btn btn-primary" type="submit">Update password</button>
              <a class="btn btn-outline-secondary" href="/profile">Cancel</a>
            </div>
          </form>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
  (function () {
    const form = document.getElementById('changePwdForm');
    const newPwd = document.getElementById('newPassword');
    const conf = document.getElementById('confirmPassword');

    if (!form) return;
    form.addEventListener('submit', function (e) {
      if (newPwd.value !== conf.value) {
        e.preventDefault();
        alert('New password and confirm password do not match');
        newPwd.focus();
        return false;
      }
      // optional: add simple client-side strength check here
      return true;
    });
  })();
</script>
