paths:

  # =====================================
  # ANALYTICS SUMMARY
  # =====================================
  /analytics/summary:
    get:
      tags: [Misc]
      summary: Platform analytics summary
      description: Returns overall analytics: totals, user distribution, task status distribution, upcoming deadlines.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Summary returned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      totals:
                        type: object
                        properties:
                          users:
                            type: integer
                          projects:
                            type: integer
                          tasks:
                            type: integer
                          dueSoon:
                            type: integer
                      usersByRole:
                        type: array
                        items:
                          type: object
                          properties:
                            role:
                              type: string
                            count:
                              type: integer
                      tasksByStatus:
                        type: array
                        items:
                          type: object
                          properties:
                            status:
                              type: string
                            count:
                              type: integer
        '401':
          $ref: './components.yaml#/components/responses/Unauthorized'
        '403':
          $ref: './components.yaml#/components/responses/Forbidden'
        '500':
          description: Server error



  # =====================================
  # TASK COMMENTS
  # =====================================

  /tasks/{taskId}/comments:
    post:
      tags: [Misc]
      summary: Add a comment to a task
      description: >
        Allows SA/Admin/Manager/Owner/Member to add comment text and/or attach up to 5 files.
      security:
        - bearerAuth: []
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
            example: 677bcab02f8ccdb7356c5c91
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                text:
                  type: string
                  example: "Please review the updated details."
                files:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        '201':
          description: Comment added successfully
        '400':
          description: Validation error
        '403':
          $ref: './components.yaml#/components/responses/Forbidden'
        '404':
          description: Task or project not found
        '500':
          description: Server error

    get:
      tags: [Misc]
      summary: Get all comments for a task
      security:
        - bearerAuth: []
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comments list
        '403':
          $ref: './components.yaml#/components/responses/Forbidden'
        '404':
          description: Task or project not found
        '500':
          description: Server error


  /tasks/{taskId}/comments/{commentId}:
    delete:
      tags: [Misc]
      summary: Delete a comment
      security:
        - bearerAuth: []
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
        - name: commentId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comment removed
        '403':
          $ref: './components.yaml#/components/responses/Forbidden'
        '404':
          description: Comment or task not found
        '500':
          description: Server error



  # =====================================
  # TASK ATTACHMENTS
  # =====================================

  /tasks/{taskId}/attachments:
    post:
      tags: [Misc]
      summary: Upload a file or multiple attachments to a task
      description: >
        Attachments are uploaded to Cloudinary. Supports both image and raw (pdf/zip/etc) uploads.
      security:
        - bearerAuth: []
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '201':
          description: Attachment(s) added
        '400':
          description: No file uploaded or bad request
        '403':
          $ref: './components.yaml#/components/responses/Forbidden'
        '404':
          description: Task or project not found
        '500':
          description: Server error


  /tasks/{taskId}/attachments/delete:
    post:
      tags: [Misc]
      summary: Delete an attachment from a task
      description: >
        Deletes a task attachment by its Cloudinary publicId.
      security:
        - bearerAuth: []
      parameters:
        - name: taskId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                publicId:
                  type: string
                  example: "teamboard/attachments/qwe123abc"
      responses:
        '200':
          description: Attachment removed
        '400':
          description: Missing or invalid parameters
        '403':
          $ref: './components.yaml#/components/responses/Forbidden'
        '404':
          description: Attachment or task not found
        '500':
          description: Server error
